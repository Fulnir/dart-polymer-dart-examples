<!DOCTYPE html>

<html>
  <head>
    <title>index</title>
    <script src="packages/polymer/boot.js"></script>
  </head>
 
  <body>
    <polymer-element name="my-element">
      <template>
        <ul id="list"></ul>
        <output id="out"></output>
      </template>
      <script type="application/dart">
      import 'package:polymer/polymer.dart';
      import 'dart:html';
      import 'dart:async';
      
      @CustomTag('my-element')
      class MyElement extends PolymerElement {
        created() {
          super.created();
          
          // NOTE this only fires once,
          // see https://groups.google.com/forum/#!topic/polymer-dev/llfRAC_cMIo
          // This is useful for waiting for a node to change in response
          // to some data change. Since we don't know when the node will
          // change, we can use onMutation.
          onMutation($['list'], (MutationObserver obs) {
            $['out'].text = 'Change detected at ${new DateTime.now()}';
          });
          
          new Timer(const Duration(seconds:1), (_) {
            $['list'].children.add(new LIElement()..text='hello from timer');
          });
        }
      }
      </script>
    </polymer-element>
    
    <my-element></my-element>
  </body>
</html>
